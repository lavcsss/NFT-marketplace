<% if activity.item.user.present? && activity.item.collection.present? && (activity.event == 'create' ||
   (activity.event == 'update' && activity.changeset.keys.include?("state") && ["executed", "expired"].include?(activity.changeset["state"].last))) %>
   <div class="member-detail">
    <% bid = activity.item %>
    <% cover_image = bid.collection.cover.present? ? bid.collection.cover : bid.collection.attachment %>
    <% if activity.event == 'create' %>
      <a>
        <span> <%= image_tag url_for(bid.user.profile_image) %> </span>
        <strong>  @<%= bid.user.full_name %> 
        <em> Offered <%= bid.crypto_currency %> <%= bid.crypto_currency_type %> to <%= bid.collection.title %> </em>
        <i> <%= time_ago_in_words(activity.created_at) %></i>
        </strong>
      </a>
    <% else %>
        <% if activity.changeset["state"].last == "executed" %>
        <a>
          <span> <%= image_tag url_for(bid.owner.profile_image) %> </span>
          <strong> @ <%= bid.owner.full_name %>
          <em> Accepted the bid for <%= bid.collection.title %> for <%= bid.crypto_currency %> <%= bid.crypto_currency_type %> </em>
          <i> <%= time_ago_in_words(activity.created_at) %> </i>
          </strong>
        </a>
        <% elsif activity.changeset["state"].last == "expired" %>
          <a>
            <span> <%= image_tag url_for(bid.owner.profile_image) %> </span>
            <strong> @ <%= bid.owner.full_name %>
            <em> Expired the bid for <%= bid.collection.title %> for <%= bid.crypto_currency %> <%= bid.crypto_currency_type %> </em>
            <i> <%= time_ago_in_words(activity.created_at) %><i>
            </strong>
          </a>
        <% end %>
    <% end %>
   </div>
<% end %>
